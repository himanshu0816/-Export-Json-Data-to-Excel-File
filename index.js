const attendanceData=[
    {
        "id" : "aaf5",
        "cns_id" : 122,
        "cns_comp_id" : 123,
        "cns_survey_name" : "Data1",
        "cns_type" : "pre",
        "cns_cnt_id" : 1234,
        "cns_questions" : [
            {
                "qs_id" : 32922,
                "question" : "We would like to ask you a few questions about social media video creators.It is okay if you are not familiar with these creators or channels.Have you ever heard of XXXXXXX?",
                "questionType" : "single",
                "import_check" : [
                    {
                        "im_id" : 29165,
                        "im_qs_id" : 32922,
                        "im_dq_id" : 59,
                        "im_opt_tag" : 167806,
                        "im_gr_tag" : null,
                        "im_category" : "Awareness"
                    }
                ],
                "edit" : {
                    "1" : "@bellapoarch"
                },
                "options" : [
                    {
                        "opt_id" : 167806,
                        "option" : "Yes",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167807,
                        "option" : "No",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ]
            },
            {
                "qs_id" : 32923,
                "question" : "Have you ever watched any video made by XXXXXXX?",
                "questionType" : "single",
                "import_check" : [
                    {
                        "im_id" : 29532,
                        "im_qs_id" : 32923,
                        "im_dq_id" : 60,
                        "im_opt_tag" : 167808,
                        "im_gr_tag" : null,
                        "im_category" : "Seen"
                    }
                ],
                "edit" : {
                    "1" : "@bellapoarch"
                },
                "options" : [
                    {
                        "opt_id" : 167808,
                        "option" : "Yes",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167809,
                        "option" : "No",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ]
            },
            {
                "qs_id" : 32924,
                "question" : "How much do you agree or disagree with the following statements about XXXXXXX?",
                "questionType" : "grid",
                "import_check" : [
                    {
                        "im_id" : 29533,
                        "im_qs_id" : 32924,
                        "im_dq_id" : 61,
                        "im_opt_tag" : 167810,
                        "im_gr_tag" : null,
                        "im_category" : "Familiarity"
                    },
                    {
                        "im_id" : 29534,
                        "im_qs_id" : 32924,
                        "im_dq_id" : 61,
                        "im_opt_tag" : 167811,
                        "im_gr_tag" : null,
                        "im_category" : "Consider"
                    },
                    {
                        "im_id" : 29536,
                        "im_qs_id" : 32924,
                        "im_dq_id" : 61,
                        "im_opt_tag" : 167812,
                        "im_gr_tag" : null,
                        "im_category" : "Lift"
                    },
                    {
                        "im_id" : 29537,
                        "im_qs_id" : 32924,
                        "im_dq_id" : 61,
                        "im_opt_tag" : 167813,
                        "im_gr_tag" : null,
                        "im_category" : "Urgency"
                    }
                ],
                "edit" : {
                    "1" : "@bellapoarch"
                },
                "options" : [
                    {
                        "opt_id" : 167810,
                        "option" : "I believe I know a lot about that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167811,
                        "option" : "I would consider watching videos made by that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167812,
                        "option" : "At some point in time, I will watch videos made by that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167813,
                        "option" : "I will watch videos made by that channel as soon as possible",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ],
                "values" : [
                    {
                        "gr_id" : 32890,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Strongly agree"
                    },
                    {
                        "gr_id" : 32891,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Somewhat agree"
                    },
                    {
                        "gr_id" : 32892,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Neither agree nor disagree"
                    },
                    {
                        "gr_id" : 32893,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Somewhat disagree"
                    },
                    {
                        "gr_id" : 32894,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Strongly disagree"
                    }
                ]
            }
        ]
    },
    {
        "id" : "aaf6",
        "cns_id" : 122,
        "cns_comp_id" : 123,
        "cns_survey_name" : "Data1",
        "cns_type" : "post",
        "cns_cnt_id" : 1234,
        "cns_questions" : [
            {
                "qs_id" : 32925,
                "question" : "Do you remember the name of the channel in the video you just saw?",
                "questionType" : "single",
                "import_check" : [
                    {
                        "im_id" : 29172,
                        "im_qs_id" : 32925,
                        "im_dq_id" : 62,
                        "im_opt_tag" : 167814,
                        "im_gr_tag" : null,
                        "im_category" : "Recall"
                    }
                ],
                "edit" : [
    
                ],
                "options" : [
                    {
                        "opt_id" : 167814,
                        "option" : "Yes",
                        "type" : "normal",
                        "rejection" : false
                    },
                    {
                        "opt_id" : 167815,
                        "option" : "No",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ]
            },
            {
                "qs_id" : 32926,
                "question" : "What was the name of the channel in the video you just saw?",
                "questionType" : "freetext",
                "import_check" : null
            },
            {
                "qs_id" : 32927,
                "question" : "What was the most memorable thing about the video you just saw?",
                "questionType" : "freetext",
                "import_check" : null,
                "edit" : [
    
                ]
            },
            {
                "qs_id" : 32928,
                "question" : "Based on the video you just saw, please tell us how much you agree or disagree with the following statements about XXXXXXX:",
                "questionType" : "grid",
                "import_check" : [
                    {
                        "im_id" : 29173,
                        "im_qs_id" : 32928,
                        "im_dq_id" : 64,
                        "im_opt_tag" : 167816,
                        "im_gr_tag" : 32895,
                        "im_category" : "Familiarity"
                    },
                    {
                        "im_id" : 29174,
                        "im_qs_id" : 32928,
                        "im_dq_id" : 64,
                        "im_opt_tag" : 167817,
                        "im_gr_tag" : 32895,
                        "im_category" : "Consider"
                    },
                    {
                        "im_id" : 29175,
                        "im_qs_id" : 32928,
                        "im_dq_id" : 64,
                        "im_opt_tag" : 167818,
                        "im_gr_tag" : 32895,
                        "im_category" : "Intent"
                    },
                    {
                        "im_id" : 29176,
                        "im_qs_id" : 32928,
                        "im_dq_id" : 64,
                        "im_opt_tag" : 167818,
                        "im_gr_tag" : 32895,
                        "im_category" : "Lift"
                    },
                    {
                        "im_id" : 29177,
                        "im_qs_id" : 32928,
                        "im_dq_id" : 64,
                        "im_opt_tag" : 167819,
                        "im_gr_tag" : 32895,
                        "im_category" : "Urgency"
                    }
                ],
                "edit" : {
                    "1" : "@Data1"
                },
                "options" : [
                    {
                        "opt_id" : 167816,
                        "option" : "I believe I know a lot about that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167817,
                        "option" : "I am considering watching videos made by that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167818,
                        "option" : "At some point in time, I will watch videos made by that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167819,
                        "option" : "I want to watch videos made by that channel as soon as possible",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ],
                "values" : [
                    {
                        "gr_id" : 32895,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Strongly agree"
                    },
                    {
                        "gr_id" : 32896,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Somewhat agree"
                    },
                    {
                        "gr_id" : 32897,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Neither agree nor disagree"
                    },
                    {
                        "gr_id" : 32898,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Somewhat disagree"
                    },
                    {
                        "gr_id" : 32899,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Strongly disagree"
                    }
                ]
            },
            {
                "qs_id" : 32929,
                "question" : "If you saw this video online, how likely would you be to take the following actions?",
                "questionType" : "grid",
                "import_check" : [
                    {
                        "im_id" : 29178,
                        "im_qs_id" : 32929,
                        "im_dq_id" : 65,
                        "im_opt_tag" : 167820,
                        "im_gr_tag" : 32900,
                        "im_category" : "Share"
                    },
                    {
                        "im_id" : 29179,
                        "im_qs_id" : 32929,
                        "im_dq_id" : 65,
                        "im_opt_tag" : 167821,
                        "im_gr_tag" : 32900,
                        "im_category" : "Trust"
                    },
                    {
                        "im_id" : 29180,
                        "im_qs_id" : 32929,
                        "im_dq_id" : 65,
                        "im_opt_tag" : 167822,
                        "im_gr_tag" : 32900,
                        "im_category" : "Persuasion"
                    }
                ],
                "edit" : [
    
                ],
                "options" : [
                    {
                        "opt_id" : 167820,
                        "option" : "Share the video on social media",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167821,
                        "option" : "Talk about the video with family and friends",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167822,
                        "option" : "Look up information about that channel",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ],
                "values" : [
                    {
                        "gr_id" : 32900,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Strongly agree"
                    },
                    {
                        "gr_id" : 32901,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Somewhat agree"
                    },
                    {
                        "gr_id" : 32902,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Neither agree nor disagree"
                    },
                    {
                        "gr_id" : 32903,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Somewhat disagree"
                    },
                    {
                        "gr_id" : 32904,
                        "type" : "normal",
                        "rejection" : false,
                        "option" : "Strongly disagree"
                    }
                ]
            },
            {
                "qs_id" : 32930,
                "question" : "How would you characterize the video you just saw?Please select all that apply:",
                "questionType" : "multiple",
                "import_check" : [
                    {
                        "im_id" : 29181,
                        "im_qs_id" : 32930,
                        "im_dq_id" : 66,
                        "im_opt_tag" : null,
                        "im_gr_tag" : null,
                        "im_category" : "Virality"
                    },
                    {
                        "im_id" : 29182,
                        "im_qs_id" : 32930,
                        "im_dq_id" : 66,
                        "im_opt_tag" : 167826,
                        "im_gr_tag" : null,
                        "im_category" : "Relatable"
                    }
                ],
                "edit" : [
    
                ],
                "options" : [
                    {
                        "opt_id" : 167823,
                        "option" : "Creative",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167824,
                        "option" : "Inspiring",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167825,
                        "option" : "Informational",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167826,
                        "option" : "Relatable",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167827,
                        "option" : "Spontaneous",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167828,
                        "option" : "Genuine",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167829,
                        "option" : "Funny",
                        "type" : "normal",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    },
                    {
                        "opt_id" : 167830,
                        "option" : "None of the above",
                        "type" : "none",
                        "rejection" : false,
                        "children" : [
    
                        ]
                    }
                ]
            }
        ]
    }
]
const filtered = attendanceData.map(obj => {
    const {
        cns_questions,
        import_check,
        edit,
        options,
        ...rest
    } = obj;


    cns_questions.map(el => {
        rest[el['id']] = el.import_check;
        
    });

    return {...rest,
        import_check,
        edit,
        options
    };
});

const XLSX = require("xlsx");
const workSheet = XLSX.utils.json_to_sheet(filtered);
const workBook = XLSX.utils.book_new();
XLSX.utils.book_append_sheet(workBook, workSheet, "attendance");
XLSX.write(workBook, { bookType: "xlsx", type: "buffer" });
XLSX.write(workBook, { bookType: "xlsx", type: "binary" });
XLSX.writeFile(workBook,"newExcel2.xlsx");